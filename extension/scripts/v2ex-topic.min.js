"use strict";var gt=$('#Top .tools > a[href^="/member"]').text(),vt=$('#Main > .box > .header > small > a[href^="/member"]').text(),Ee=$("#Main #Tabs ~ .cell.item"),st=$("#Main .box:has(.topic_content)"),P=$('#Main .box:has(.cell[id^="r_"])'),R=P.find('.cell[id^="r_"]'),j=R.find("> table > tbody > tr"),D=j.map((t,e)=>{let n=R[t].id,o=$(e).find("> td:nth-child(3)"),i=o.find("> strong > a"),s=i.text(),r=i.prop("href"),c=o.find("> .reply_content").text(),l=Number(o.find("span.small").text()),a=o.find("span.no").text(),f=Array.from(c.matchAll(/@([a-zA-Z0-9]+)/g)),d=f.length>0?f.map(([,u])=>u):void 0,p=Array.from(c.matchAll(/#(\d+)/g)),m=p.length>0?p.map(([,u])=>u):void 0;return{id:n,memberName:s,memberLink:r,content:c,likes:l,floor:a,index:t,refMemberNames:d,refFloors:m}}).get();function V(t){let{children:e,className:n="",type:o="button"}=t;return $(`<button class="normal button ${n}" type="${o}">${e}</button>`)}function xt(t){let{root:e,title:n,onOpen:o,onClose:i,onMount:s}=t,r=$('<div class="v2p-model-mask">'),c=$('<div class="v2p-model-content">'),l=V({children:"\u5173\u95ED<kbd>Esc</kbd>",className:"v2p-model-close-btn"}),a=$(`<div class="v2p-model-title">${n??""}</div>`),f=$('<div class="v2p-model-actions">').append(l),d=$('<div class="v2p-model-header">').append(a,f),p=$('<div class="v2p-model-main">').append(d,c),m=r.append(p).hide(),u={$mask:r,$main:p,$container:m,$title:a,$actions:f,$content:c},h=!1,x=y=>{$(y.target).closest(p).length===0&&g()},v=y=>{y.key==="Escape"&&g()},g=()=>{$(document).off("click",x),$(document).off("keydown",v),h=!1,m.fadeOut("fast"),document.body.classList.remove("v2p-modal-open"),i?.(u)},w=()=>{setTimeout(()=>{h||($(document).on("click",x),$(document).on("keydown",v),h=!0)},0),m.fadeIn("fast"),document.body.classList.add("v2p-modal-open"),o?.(u)};return l.on("click",g),s?.(u),e&&e.append(m),{...u,open:w,close:g}}function X(t){return t.split("-")[1]}function bt(t){return t==="y"?"height":"width"}function M(t){return t.split("-")[0]}function G(t){return["top","bottom"].includes(M(t))?"x":"y"}function wt(t,e,n){let{reference:o,floating:i}=t,s=o.x+o.width/2-i.width/2,r=o.y+o.height/2-i.height/2,c=G(e),l=bt(c),a=o[l]/2-i[l]/2,f=M(e),d=c==="x",p;switch(f){case"top":p={x:s,y:o.y-i.height};break;case"bottom":p={x:s,y:o.y+o.height};break;case"right":p={x:o.x+o.width,y:r};break;case"left":p={x:o.x-i.width,y:r};break;default:p={x:o.x,y:o.y}}switch(X(e)){case"start":p[c]-=a*(n&&d?-1:1);break;case"end":p[c]+=a*(n&&d?-1:1);break}return p}var Ct=async(t,e,n)=>{let{placement:o="bottom",strategy:i="absolute",middleware:s=[],platform:r}=n,c=s.filter(Boolean),l=await(r.isRTL==null?void 0:r.isRTL(e)),a=await r.getElementRects({reference:t,floating:e,strategy:i}),{x:f,y:d}=wt(a,o,l),p=o,m={},u=0;for(let h=0;h<c.length;h++){let{name:x,fn:v}=c[h],{x:g,y:w,data:y,reset:b}=await v({x:f,y:d,initialPlacement:o,placement:p,strategy:i,middlewareData:m,rects:a,platform:r,elements:{reference:t,floating:e}});if(f=g??f,d=w??d,m={...m,[x]:{...m[x],...y}},b&&u<=50){u++,typeof b=="object"&&(b.placement&&(p=b.placement),b.rects&&(a=b.rects===!0?await r.getElementRects({reference:t,floating:e,strategy:i}):b.rects),{x:f,y:d}=wt(a,p,l)),h=-1;continue}}return{x:f,y:d,placement:p,strategy:i,middlewareData:m}};function Zt(t){return{top:0,right:0,bottom:0,left:0,...t}}function te(t){return typeof t!="number"?Zt(t):{top:t,right:t,bottom:t,left:t}}function Q(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}async function ct(t,e){var n;e===void 0&&(e={});let{x:o,y:i,platform:s,rects:r,elements:c,strategy:l}=t,{boundary:a="clippingAncestors",rootBoundary:f="viewport",elementContext:d="floating",altBoundary:p=!1,padding:m=0}=e,u=te(m),x=c[p?d==="floating"?"reference":"floating":d],v=Q(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(x)))==null||n?x:x.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(c.floating)),boundary:a,rootBoundary:f,strategy:l})),g=d==="floating"?{...r.floating,x:o,y:i}:r.reference,w=await(s.getOffsetParent==null?void 0:s.getOffsetParent(c.floating)),y=await(s.isElement==null?void 0:s.isElement(w))?await(s.getScale==null?void 0:s.getScale(w))||{x:1,y:1}:{x:1,y:1},b=Q(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:g,offsetParent:w,strategy:l}):g);return{top:(v.top-b.top+u.top)/y.y,bottom:(b.bottom-v.bottom+u.bottom)/y.y,left:(v.left-b.left+u.left)/y.x,right:(b.right-v.right+u.right)/y.x}}var ee=Math.min,ne=Math.max;function yt(t,e,n){return ne(t,ee(e,n))}var oe={left:"right",right:"left",bottom:"top",top:"bottom"};function U(t){return t.replace(/left|right|bottom|top/g,e=>oe[e])}function ie(t,e,n){n===void 0&&(n=!1);let o=X(t),i=G(t),s=bt(i),r=i==="x"?o===(n?"end":"start")?"right":"left":o==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(r=U(r)),{main:r,cross:U(r)}}var se={start:"end",end:"start"};function rt(t){return t.replace(/start|end/g,e=>se[e])}function re(t){let e=U(t);return[rt(t),e,rt(e)]}function ce(t,e,n){let o=["left","right"],i=["right","left"],s=["top","bottom"],r=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:o:e?o:i;case"left":case"right":return e?s:r;default:return[]}}function le(t,e,n,o){let i=X(t),s=ce(M(t),n==="start",o);return i&&(s=s.map(r=>r+"-"+i),e&&(s=s.concat(s.map(rt)))),s}var Y=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n;let{placement:o,middlewareData:i,rects:s,initialPlacement:r,platform:c,elements:l}=e,{mainAxis:a=!0,crossAxis:f=!0,fallbackPlacements:d,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:u=!0,...h}=t,x=M(o),v=M(r)===r,g=await(c.isRTL==null?void 0:c.isRTL(l.floating)),w=d||(v||!u?[U(r)]:re(r));!d&&m!=="none"&&w.push(...le(r,u,m,g));let y=[r,...w],b=await ct(e,h),S=[],L=((n=i.flip)==null?void 0:n.overflows)||[];if(a&&S.push(b[x]),f){let{main:N,cross:J}=ie(o,s,g);S.push(b[N],b[J])}if(L=[...L,{placement:o,overflows:S}],!S.every(N=>N<=0)){var mt,ut;let N=(((mt=i.flip)==null?void 0:mt.index)||0)+1,J=y[N];if(J)return{data:{index:N,overflows:L},reset:{placement:J}};let F=(ut=L.filter(B=>B.overflows[0]<=0).sort((B,I)=>B.overflows[1]-I.overflows[1])[0])==null?void 0:ut.placement;if(!F)switch(p){case"bestFit":{var ht;let B=(ht=L.map(I=>[I.placement,I.overflows.filter(_=>_>0).reduce((_,Kt)=>_+Kt,0)]).sort((I,_)=>I[1]-_[1])[0])==null?void 0:ht[0];B&&(F=B);break}case"initialPlacement":F=r;break}if(o!==F)return{reset:{placement:F}}}return{}}}};async function ae(t,e){let{placement:n,platform:o,elements:i}=t,s=await(o.isRTL==null?void 0:o.isRTL(i.floating)),r=M(n),c=X(n),l=G(n)==="x",a=["left","top"].includes(r)?-1:1,f=s&&l?-1:1,d=typeof e=="function"?e(t):e,{mainAxis:p,crossAxis:m,alignmentAxis:u}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return c&&typeof u=="number"&&(m=c==="end"?u*-1:u),l?{x:m*f,y:p*a}:{x:p*a,y:m*f}}var K=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){let{x:n,y:o}=e,i=await ae(e,t);return{x:n+i.x,y:o+i.y,data:i}}}};function fe(t){return t==="x"?"y":"x"}var Z=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){let{x:n,y:o,placement:i}=e,{mainAxis:s=!0,crossAxis:r=!1,limiter:c={fn:x=>{let{x:v,y:g}=x;return{x:v,y:g}}},...l}=t,a={x:n,y:o},f=await ct(e,l),d=G(M(i)),p=fe(d),m=a[d],u=a[p];if(s){let x=d==="y"?"top":"left",v=d==="y"?"bottom":"right",g=m+f[x],w=m-f[v];m=yt(g,m,w)}if(r){let x=p==="y"?"top":"left",v=p==="y"?"bottom":"right",g=u+f[x],w=u-f[v];u=yt(g,u,w)}let h=c.fn({...e,[d]:m,[p]:u});return{...h,data:{x:h.x-n,y:h.y-o}}}}};function C(t){var e;return((e=t.ownerDocument)==null?void 0:e.defaultView)||window}function A(t){return C(t).getComputedStyle(t)}var At=Math.min,z=Math.max,et=Math.round;function Tt(t){let e=A(t),n=parseFloat(e.width),o=parseFloat(e.height),i=t.offsetWidth,s=t.offsetHeight,r=et(n)!==i||et(o)!==s;return r&&(n=i,o=s),{width:n,height:o,fallback:r}}function E(t){return Lt(t)?(t.nodeName||"").toLowerCase():""}var tt;function Ot(){if(tt)return tt;let t=navigator.userAgentData;return t&&Array.isArray(t.brands)?(tt=t.brands.map(e=>e.brand+"/"+e.version).join(" "),tt):navigator.userAgent}function k(t){return t instanceof C(t).HTMLElement}function T(t){return t instanceof C(t).Element}function Lt(t){return t instanceof C(t).Node}function $t(t){if(typeof ShadowRoot>"u")return!1;let e=C(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function nt(t){let{overflow:e,overflowX:n,overflowY:o,display:i}=A(t);return/auto|scroll|overlay|hidden|clip/.test(e+o+n)&&!["inline","contents"].includes(i)}function de(t){return["table","td","th"].includes(E(t))}function lt(t){let e=/firefox/i.test(Ot()),n=A(t),o=n.backdropFilter||n.WebkitBackdropFilter;return n.transform!=="none"||n.perspective!=="none"||(o?o!=="none":!1)||e&&n.willChange==="filter"||e&&(n.filter?n.filter!=="none":!1)||["transform","perspective"].some(i=>n.willChange.includes(i))||["paint","layout","strict","content"].some(i=>{let s=n.contain;return s!=null?s.includes(i):!1})}function at(){return/^((?!chrome|android).)*safari/i.test(Ot())}function ft(t){return["html","body","#document"].includes(E(t))}function Pt(t){return T(t)?t:t.contextElement}var Mt={x:1,y:1};function H(t){let e=Pt(t);if(!k(e))return Mt;let n=e.getBoundingClientRect(),{width:o,height:i,fallback:s}=Tt(e),r=(s?et(n.width):n.width)/o,c=(s?et(n.height):n.height)/i;return(!r||!Number.isFinite(r))&&(r=1),(!c||!Number.isFinite(c))&&(c=1),{x:r,y:c}}function q(t,e,n,o){var i,s;e===void 0&&(e=!1),n===void 0&&(n=!1);let r=t.getBoundingClientRect(),c=Pt(t),l=Mt;e&&(o?T(o)&&(l=H(o)):l=H(t));let a=c?C(c):window,f=at()&&n,d=(r.left+(f&&((i=a.visualViewport)==null?void 0:i.offsetLeft)||0))/l.x,p=(r.top+(f&&((s=a.visualViewport)==null?void 0:s.offsetTop)||0))/l.y,m=r.width/l.x,u=r.height/l.y;if(c){let h=C(c),x=o&&T(o)?C(o):o,v=h.frameElement;for(;v&&o&&x!==h;){let g=H(v),w=v.getBoundingClientRect(),y=getComputedStyle(v);w.x+=(v.clientLeft+parseFloat(y.paddingLeft))*g.x,w.y+=(v.clientTop+parseFloat(y.paddingTop))*g.y,d*=g.x,p*=g.y,m*=g.x,u*=g.y,d+=w.x,p+=w.y,v=C(v).frameElement}}return{width:m,height:u,top:p,right:d+m,bottom:p+u,left:d,x:d,y:p}}function O(t){return((Lt(t)?t.ownerDocument:t.document)||window.document).documentElement}function ot(t){return T(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function pe(t){let{rect:e,offsetParent:n,strategy:o}=t,i=k(n),s=O(n);if(n===s)return e;let r={scrollLeft:0,scrollTop:0},c={x:1,y:1},l={x:0,y:0};if((i||!i&&o!=="fixed")&&((E(n)!=="body"||nt(s))&&(r=ot(n)),k(n))){let a=q(n);c=H(n),l.x=a.x+n.clientLeft,l.y=a.y+n.clientTop}return{width:e.width*c.x,height:e.height*c.y,x:e.x*c.x-r.scrollLeft*c.x+l.x,y:e.y*c.y-r.scrollTop*c.y+l.y}}function St(t){return q(O(t)).left+ot(t).scrollLeft}function me(t){let e=O(t),n=ot(t),o=t.ownerDocument.body,i=z(e.scrollWidth,e.clientWidth,o.scrollWidth,o.clientWidth),s=z(e.scrollHeight,e.clientHeight,o.scrollHeight,o.clientHeight),r=-n.scrollLeft+St(t),c=-n.scrollTop;return A(o).direction==="rtl"&&(r+=z(e.clientWidth,o.clientWidth)-i),{width:i,height:s,x:r,y:c}}function W(t){if(E(t)==="html")return t;let e=t.assignedSlot||t.parentNode||$t(t)&&t.host||O(t);return $t(e)?e.host:e}function Nt(t){let e=W(t);return ft(e)?e.ownerDocument.body:k(e)&&nt(e)?e:Nt(e)}function Bt(t,e){var n;e===void 0&&(e=[]);let o=Nt(t),i=o===((n=t.ownerDocument)==null?void 0:n.body),s=C(o);return i?e.concat(s,s.visualViewport||[],nt(o)?o:[]):e.concat(o,Bt(o))}function ue(t,e){let n=C(t),o=O(t),i=n.visualViewport,s=o.clientWidth,r=o.clientHeight,c=0,l=0;if(i){s=i.width,r=i.height;let a=at();(!a||a&&e==="fixed")&&(c=i.offsetLeft,l=i.offsetTop)}return{width:s,height:r,x:c,y:l}}function he(t,e){let n=q(t,!0,e==="fixed"),o=n.top+t.clientTop,i=n.left+t.clientLeft,s=k(t)?H(t):{x:1,y:1},r=t.clientWidth*s.x,c=t.clientHeight*s.y,l=i*s.x,a=o*s.y;return{width:r,height:c,x:l,y:a}}function kt(t,e,n){let o;if(e==="viewport")o=ue(t,n);else if(e==="document")o=me(O(t));else if(T(e))o=he(e,n);else{let r={...e};if(at()){var i,s;let c=C(t);r.x-=((i=c.visualViewport)==null?void 0:i.offsetLeft)||0,r.y-=((s=c.visualViewport)==null?void 0:s.offsetTop)||0}o=r}return Q(o)}function ge(t,e){let n=e.get(t);if(n)return n;let o=Bt(t).filter(c=>T(c)&&E(c)!=="body"),i=null,s=A(t).position==="fixed",r=s?W(t):t;for(;T(r)&&!ft(r);){let c=A(r),l=lt(r);c.position==="fixed"?i=null:(s?!l&&!i:!l&&c.position==="static"&&!!i&&["absolute","fixed"].includes(i.position))?o=o.filter(d=>d!==r):i=c,r=W(r)}return e.set(t,o),o}function ve(t){let{element:e,boundary:n,rootBoundary:o,strategy:i}=t,r=[...n==="clippingAncestors"?ge(e,this._c):[].concat(n),o],c=r[0],l=r.reduce((a,f)=>{let d=kt(e,f,i);return a.top=z(d.top,a.top),a.right=At(d.right,a.right),a.bottom=At(d.bottom,a.bottom),a.left=z(d.left,a.left),a},kt(e,c,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function xe(t){return k(t)?Tt(t):t.getBoundingClientRect()}function Rt(t,e){return!k(t)||A(t).position==="fixed"?null:e?e(t):t.offsetParent}function we(t){let e=W(t);for(;k(e)&&!ft(e);){if(lt(e))return e;e=W(e)}return null}function Et(t,e){let n=C(t),o=Rt(t,e);for(;o&&de(o)&&A(o).position==="static";)o=Rt(o,e);return o&&(E(o)==="html"||E(o)==="body"&&A(o).position==="static"&&!lt(o))?n:o||we(t)||n}function ye(t,e,n){let o=k(e),i=O(e),s=q(t,!0,n==="fixed",e),r={scrollLeft:0,scrollTop:0},c={x:0,y:0};if(o||!o&&n!=="fixed")if((E(e)!=="body"||nt(i))&&(r=ot(e)),k(e)){let l=q(e,!0);c.x=l.x+e.clientLeft,c.y=l.y+e.clientTop}else i&&(c.x=St(i));return{x:s.left+r.scrollLeft-c.x,y:s.top+r.scrollTop-c.y,width:s.width,height:s.height}}var be={getClippingRect:ve,convertOffsetParentRelativeRectToViewportRelativeRect:pe,isElement:T,getDimensions:xe,getOffsetParent:Et,getDocumentElement:O,getScale:H,async getElementRects(t){let{reference:e,floating:n,strategy:o}=t,i=this.getOffsetParent||Et,s=this.getDimensions;return{reference:ye(e,await i(n),o),floating:{x:0,y:0,...await s(n)}}},getClientRects:t=>Array.from(t.getClientRects()),isRTL:t=>A(t).direction==="rtl"};var dt=(t,e,n)=>{let o=new Map,i={platform:be,...n},s={...i.platform,_c:o};return Ct(t,e,{...i,platform:s})};var It=[{title:"Smileys",list:["\u{1F600}","\u{1F603}","\u{1F604}","\u{1F601}","\u{1F606}","\u{1F605}","\u{1F923}","\u{1F602}","\u{1F642}","\u{1F643}","\u{1F609}","\u{1F62E}","\u{1F632}","\u{1F633}","\u{1F631}","\u{1F62D}","\u{1F61E}","\u{1F613}","\u{1F629}","\u{1F61A}","\u{1F92D}","\u{1F60F}","\u{1F612}","\u{1F621}","\u{1F624}"]},{title:"Others",list:["\u{1F47B}","\u{1F44B}","\u{1F91A}","\u{1F590}","\u{1F596}","\u{1F436}","\u{1F414}","\u{1F921}","\u{1F4A9}"]}],pt=250,Dt=550,Fe=60*60*1e3;var Ht=`
<svg
  xmlns="http://www.w3.org/2000/svg"
  fill="none"
  viewBox="0 0 24 24"
  stroke-width="1.5"
  stroke="currentColor"
  style="width:18px; height:18px;"
>
  <path
    stroke-linecap="round"
    stroke-linejoin="round"
    d="M15.182 15.182a4.5 4.5 0 01-6.364 0M21 12a9 9 0 11-18 0 9 9 0 0118 0zM9.75 9.75c0 .414-.168.75-.375.75S9 10.164 9 9.75 9.168 9 9.375 9s.375.336.375.75zm-.375 0h.008v.015h-.008V9.75zm5.625 0c0 .414-.168.75-.375.75s-.375-.336-.375-.75.168-.75.375-.75.375.336.375.75zm-.375 0h.008v.015h-.008V9.75z"
  />
</svg>
`,it=`
<svg
  xmlns="http://www.w3.org/2000/svg"
  fill="none"
  viewBox="0 0 24 24"
  stroke-width="1.5"
  stroke="currentColor"
>
  <path
    stroke-linecap="round"
    stroke-linejoin="round"
    d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"
  />
</svg>
`,Ft=`
<svg
  xmlns="http://www.w3.org/2000/svg"
  fill="none"
  viewBox="0 0 24 24"
  stroke-width="1.5"
  stroke="currentColor"
>
  <path
    stroke-linecap="round"
    stroke-linejoin="round"
    d="M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88"
  />
</svg>
`,_t=`
<svg
  xmlns="http://www.w3.org/2000/svg"
  fill="none"
  viewBox="0 0 24 24"
  stroke-width="1.5"
  stroke="currentColor"
>
  <path
    stroke-linecap="round"
    stroke-linejoin="round"
    d="M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 01.865-.501 48.172 48.172 0 003.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z"
  />
</svg>
`,jt=`
<svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <polygon
    points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"
  ></polygon>
</svg>
`,Vt=`
<svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path
    d="M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z"
  ></path>
</svg>
`,zt=`
<svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <circle cx="12" cy="12" r="10"></circle>
  <path d="M8 15h8"></path>
  <path d="M8 9h2"></path>
  <path d="M14 9h2"></path>
</svg>
`,qt=`
<svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path
    d="M20.42 4.58a5.4 5.4 0 0 0-7.65 0l-.77.78-.77-.78a5.4 5.4 0 0 0-7.65 0C1.46 6.7 1.33 10.28 4 13l8 8 8-8c2.67-2.72 2.54-6.3.42-8.42z"
  ></path>
</svg>
`;async function Ce(t,e){let n=await fetch(t,e),o=n.headers.get("X-Rate-Limit-Limit"),i=n.headers.get("X-Rate-Limit-Reset"),s=n.headers.get("X-Rate-Limit-Remaining"),r={limit:o?Number(o):void 0,reset:i?Number(i):void 0,remaining:s?Number(s):void 0};return await chrome.storage.sync.set({["legacy-api"]:r}),n.json()}function Wt(t,e){return Ce(`${"https://www.v2ex.com/api"}/members/show.json?username=${t}`,e)}function Jt(){let t=window.navigator.userAgent.toLowerCase(),e=/(macintosh|macintel|macppc|mac68k|macos)/i,n=/(win32|win64|windows|wince)/i,o=/(iphone|ipad|ipod)/i,i=null;return e.test(t)?i="macos":o.test(t)?i="ios":n.test(t)?i="windows":t.includes("android")?i="android":t.includes("linux")&&(i="linux"),i}function Qt(t,e=!1){let n=new Date(t*1e3),o=n.getFullYear().toString(),i=(n.getMonth()+1).toString().padStart(2,"0"),s=n.getDate().toString().padStart(2,"0"),r=`${o}-${i}-${s}`;if(e){let c=n.getHours().toString().padStart(2,"0"),l=n.getMinutes().toString().padStart(2,"0"),a=n.getSeconds().toString().padStart(2,"0");return`${r} ${c}:${l}:${a}`}return r}function Ae(t,e,n){let o=e.get(0),i=null,s=l=>{$(l.target).closest(o).length===0&&r()},r=()=>{i?.abort(),o.style.visibility="hidden",o.innerHTML="",$(document).off("click",s)},c=$(t).find(".avatar");c.on("click",l=>{if(i=new AbortController,o.style.visibility==="visible")r();else{l.stopPropagation(),$(document).on("click",s),dt(c.get(0),o,{placement:"bottom-start",middleware:[K({mainAxis:10,crossAxis:-4}),Y(),Z({padding:8})]}).then(({x:f,y:d})=>{Object.assign(o.style,{left:`${f}px`,top:`${d}px`}),o.style.visibility="visible"}).catch(f=>{console.error("\u8BA1\u7B97\u4F4D\u7F6E\u5931\u8D25",f),r()});let a=$(`
              <div class="v2p-ctn">
                <div class="v2p-ctn-left">
                  <div class="v2p-avatar-box"></div>
                </div>

                <div class="v2p-ctn-right">
                  <div class="v2p-username v2p-loading"></div>
                  <div class="v2p-no v2p-loading"></div>
                  <div class="v2p-created-date v2p-loading"></div>
                </div>
              </div>
              `);e.append(a),setTimeout(()=>{Wt(n.memberName,{signal:i?.signal}).then(f=>{e.find(".v2p-avatar-box").removeClass("v2p-loading").append(`<img class="v2p-avatar" src="${f.avatar_large}">`),e.find(".v2p-username").removeClass("v2p-loading").text(f.username),e.find(".v2p-no").removeClass("v2p-loading").text(`V2EX \u7B2C ${f.id} \u53F7\u4F1A\u5458`),e.find(".v2p-created-date").removeClass("v2p-loading").text(`\u52A0\u5165\u4E8E ${Qt(f.created)}`),f.bio&&f.bio.trim().length>0&&e.append(`<div class="v2p-bio">${f.bio}</div>`)}).catch(f=>{f.name!=="AbortError"&&e.html("<span>\u83B7\u53D6\u7528\u6237\u4FE1\u606F\u5931\u8D25</span>")})},0)}})}function Ut(t){let e=$(t);if(e.find(".v2p-reply-content").length>0)return;let n=e.find(".reply_content");if((n.height()??0)+pt>=Dt){let s={maxHeight:`${pt}px`,overflow:"hidden",paddingBottom:"0"},r=$('<div class="v2p-reply-content v2p-collapsed">').css(s),c=V({children:"\u5C55\u5F00\u56DE\u590D",className:"v2p-expand-btn"}),l=()=>{let a=r.hasClass("v2p-collapsed");r.toggleClass("v2p-collapsed").css(a?{maxHeight:"none",overflow:"auto",paddingBottom:"40px"}:s),c.html(a?"\u6536\u8D77\u56DE\u590D":"\u5C55\u5F00\u56DE\u590D")};c.on("click",()=>{l()}),r.append(n.clone()).replaceAll(n).append(c)}}function $e(){let t=D.filter(({likes:n})=>n>0).sort((n,o)=>o.likes-n.likes);if(t.length<=0)return;let e=xt({root:P,title:`\u672C\u9875\u5171\u6709 ${t.length} \u6761\u70ED\u95E8\u56DE\u590D`,onMount:({$content:n})=>{let o=$("<templete></templete>");t.forEach(({index:i})=>{o.append(R.eq(i).clone())}),n.css({padding:"0 20px"}).append(o.html())},onOpen:({$container:n})=>{n.find('.cell[id^="r_"]').each((o,i)=>{Ut(i)})}});{let n=P.find(".cell:first-of-type > span.gray"),o=n.text(),s=`<span class="count-text">${o.substring(0,o.indexOf("\u56DE\u590D")+2)}</span><span class="v2p-dot">\xB7</span>`,r=$(`<span class="v2p-popular-btn v2p-hover-btn"><span class="v2p-icon-heart">${it}</span>\u67E5\u770B\u672C\u9875\u611F\u8C22\u56DE\u590D</span>`);r.on("click",()=>{e.open()}),n.empty().append(s).append(r)}}function ke(){j.find("> td:last-of-type > .fr").each((e,n)=>{let o=$(n),i=$('<span class="v2p-controls">'),s=$(`<span class="v2p-control">${it}</span>`),r=o.find("> .thank_area");if(r.hasClass("thanked"))s.prop("title","\u5DF2\u611F\u8C22").css({color:"#f43f5e",cursor:"default"}),i.append($("<a>").append(s));else{let f=r.find("> .thank"),d=f.eq(0).removeClass("thank"),p=f.eq(1).removeClass("thank");d.html(`<span class="v2p-control v2p-hover-btn" title="\u9690\u85CF">${Ft}</span>`),s.prop("title","\u611F\u8C22").addClass("v2p-hover-btn"),p.empty().append(s),i.append(d).append(p)}let l=o.find("a:last-of-type");l.find('> img[alt="Reply"]').replaceWith(`<span class="v2p-control v2p-ac-reply v2p-hover-btn" title="\u56DE\u590D">${_t}</span>`),i.append(l),r.remove();let a=o.find(".no").clone();o.empty().append(i,a)})}function Re(){let t=Jt(),e=$("#reply-box"),n=document.querySelector("#reply_content"),o=V({children:`\u56DE\u590D<kbd>${t==="macos"?"Cmd":"Ctrl"}+Enter</kbd>`,type:"submit"}).replaceAll(e.find('input[type="submit"]')),i=$('<div class="v2p-emoji-group">'),s=$('<div class="v2p-emoji-list">'),r=$('<span class="v2p-emoji">'),c=It.map(h=>{let x=i.clone();x.append(`<div class="v2p-emoji-title">${h.title}</div>`);let v=s.clone().append(h.list.map(g=>r.clone().text(g).on("click",()=>{if(n instanceof HTMLTextAreaElement){let y=n.selectionStart,b=n.selectionEnd,S=n.value.substring(0,y),L=n.value.substring(b,n.value.length);n.value=`${S}${g}${L}`,n.focus(),n.selectionStart=n.selectionEnd=y+g.length}})));return x.append(v),x}),l=$('<div class="v2p-emoticons-box">').append(c),a=V({children:Ht}).insertAfter(o),f=$('<div id="v2p-emoji-popup">').append(l).appendTo($("#reply-box")).get(0),d=h=>{h.key==="Escape"&&(h.stopPropagation(),m())},p=h=>{$(h.target).closest(f).length===0&&m()},m=()=>{f.style.visibility="hidden",$(document).off("click",p),$("body").off("keydown",d)},u=()=>{$(document).on("click",p),$("body").on("keydown",d),dt(a.get(0),f,{placement:"right-end",middleware:[K({mainAxis:10,crossAxis:8}),Y(),Z({padding:8})]}).then(({x:h,y:x})=>{Object.assign(f.style,{left:`${h}px`,top:`${x}px`}),f.style.visibility="visible"}).catch(()=>{m()})};a.on("click",h=>{h.stopPropagation(),f.style.visibility==="visible"?m():u(),n instanceof HTMLTextAreaElement&&n.focus()}),e.find("#undock-button, #undock-button + a").addClass("v2p-hover-btn").css("padding","5px 4px")}function Xt(){R.find(".small.fade").addClass("v2p-heart-box").find('img[alt="\u2764\uFE0F"]').replaceWith(`<span class="v2p-icon-heart">${it}</span>`),ke(),$e();{let t=$('<div id="v2p-member-popup" tabindex="0">').appendTo(P);R.each((e,n)=>{let o=D.at(e);o&&Ae(n,t,o),Ut(n);let i=o?.id===n.id?o:D.find(s=>s.id===n.id);if(i){let{memberName:s,refMemberNames:r,refFloors:c}=i;if(s===gt&&$(n).find(".badges").append(`<div class="badge ${s===vt?"mod":"you"}">YOU</div>`),!r||r.length===0)return;for(let l of r)for(let a=e-1;a>=0;a--){let{memberName:f,floor:d}=D.at(a)||{};if(f===l){let p=c?.at(0);if(p&&p!==d){let m=D.slice(0,a).findIndex(u=>u.floor===p);if(m>=0){R.eq(m).append(n);return}}R.eq(a).append(n);return}}}})}Re()}function Gt(){st.find(".topic_content a[href]").prop("target","_blank").prop("rel","noopener noreferrer");{let t=st.find(".subtle > .topic_content"),e=t.text().length;e>=200&&t.each((n,o)=>{e>=400&&(o.style.fontSize="13px"),o.style.fontSize="14px"})}{let t=$(".topic_buttons .tb").addClass("v2p-tb v2p-hover-btn");t.eq(0).append(`<span class="v2p-tb-icon">${jt}</span>`),t.eq(1).append(`<span class="v2p-tb-icon">${Vt}</span>`),t.eq(2).append(`<span class="v2p-tb-icon">${zt}</span>`),t.eq(3).append(`<span class="v2p-tb-icon">${qt}</span>`)}}function Yt(){let t=P.find('> .cell:not([id^="r_"])');if(t.length<=1)return;let n=t.slice(1).addClass("v2p-paging").find(".super.button");n.eq(0).addClass("v2p-prev-btn"),n.eq(1).addClass("v2p-next-btn")}j.find("> td:nth-child(3) > strong > a").prop("target","_blank").prop("rel","noopener noreferrer");$(document).on("keydown",t=>{if(t.key==="Escape"){let e=$("#reply-box"),n=$("#reply_content");e.hasClass("reply-box-sticky")&&(e.removeClass("reply-box-sticky"),$("#undock-button").css("display","none")),n.trigger("blur")}});Gt();if(document.referrer!==""&&document.referrer.includes(document.location.pathname)){let e=new URL(document.location.href).searchParams.get("p");e&&e!=="1"&&document.querySelector(".topic_buttons")?.scrollIntoView({behavior:"smooth"})}Xt();Yt();
