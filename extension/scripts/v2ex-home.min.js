"use strict";var w=$('#Top .tools > a[href^="/member"]').text(),A=$("#Main > .box:nth-child(1) > .header > small > a").text(),h=$("#Main #Tabs ~ .cell.item"),N=$("#Main .box:has(.topic_content)"),T=$('#Main .box:has(.cell[id^="r_"])'),f=T.find('.cell[id^="r_"]'),_=f.find("> table > tbody > tr"),P=_.map((o,e)=>{let p=f[o].id,t=$(e).find("> td:nth-child(3)"),n=t.find("> strong > a"),l=n.text(),r=n.prop("href"),i=t.find("> .reply_content").text(),c=Number(t.find("span.small").text()),s=t.find("span.no").text(),a=Array.from(i.matchAll(/@(\S+)\s/g)),b=a.length>0?a.map(([,m])=>m):void 0,d=Array.from(i.matchAll(/#(\d+)/g)),v=d.length>0?d.map(([,m])=>m):void 0;return{id:p,memberName:l,memberLink:r,content:i,likes:c,floor:s,index:o,refMemberNames:b,refFloors:v}}).get();async function u(o,e){let t=await(await fetch(`${"https://www.v2ex.com/api/v2"}/topics/${o}`,{method:"GET",headers:{Authorization:`Bearer ${e}`}})).json();return console.log(t),t}function x(){chrome.storage.sync.get("options",o=>{let e=o.options?.["PAT"];e&&h.each((p,t)=>{let n=$(t);$('<button class="v2p-topic-preview-btn">\u9884\u89C8</button>').on("click",()=>{let r=n.find(".topic-link").attr("href")?.match(/\/(\d+)#/);if(r){let i=r[1];u(i,e).then(c=>{let s=c.result;$(`
                <div class="v2p-topic-preview">
                <div class="v2p-topic-preview__title">${s.title}</div>
                <div class="v2p-topic-preview__content">${s.content_rendered}</div>
                </div>
                `).appendTo(n)}).catch(c=>{console.log(c)})}}).prependTo(n.find(".topic_info"))})})}$("#Main .tab").addClass("v2p-hover-btn"),$('#Main .topic-link, .item_hot_topic_title > a, .item_node, a[href="/write"]').prop("target","_blank");x();
