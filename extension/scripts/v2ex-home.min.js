"use strict";var _=$('#Top .tools > a[href^="/member"]').text(),v=$("#Main > .box:nth-child(1) > .header > small > a").text(),p=$("#Main #Tabs ~ .cell.item"),A=$("#Main .box:has(.topic_content)"),b=$('#Main .box:has(.cell[id^="r_"])'),f=b.find('.cell[id^="r_"]'),g=f.find("> table > tbody > tr"),k=g.map((c,s)=>{let n=f[c].id,o=$(s).find("> td:nth-child(3)"),r=o.find("> strong > a"),i=r.text(),a=r.prop("href"),t=o.find("> .reply_content").text(),e=Number(o.find("span.small").text()),x=o.find("span.no").text(),m=Array.from(t.matchAll(/@(\S+)\s/g)),u=m.length>0?m.map(([,l])=>l):void 0,d=Array.from(t.matchAll(/#(\d+)/g)),w=d.length>0?d.map(([,l])=>l):void 0;return{id:n,memberName:i,memberLink:a,content:t,likes:e,floor:x,index:c,refMemberNames:u,refFloors:w}}).get();function h(){p.each((c,s)=>{let n=$(s),o=$('<div class="v2p-topic-index">\u9884\u89C8</div>').on("click",()=>{console.log("click");let i=n.find(".topic-link").attr("href")?.match(/\/(\d+)#/);if(i){let a=i[1],t=localStorage.getItem("v2p_pat");t&&fetch(`${"https://www.v2ex.com/api/v2"}/topics/${a}`,{method:"GET",headers:{Authorization:`Bearer ${t}`}}).then(e=>{console.log(e)}).catch(e=>{console.error(e)})}}).insertAfter(n.find(".count_livid"))})}$("#Main .tab").addClass("v2p-hover-btn"),$('#Main .topic-link, .item_hot_topic_title > a, .item_node, a[href="/write"]').prop("target","_blank");h();
