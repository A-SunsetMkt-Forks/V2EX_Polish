"use strict";var P=$('#Top .tools > a[href^="/member"]').text(),_=$("#Main > .box:nth-child(1) > .header > small > a").text(),f=$("#Main #Tabs ~ .cell.item"),v=$("#Main .box:has(.topic_content)"),b=$('#Main .box:has(.cell[id^="r_"])'),h=b.find('.cell[id^="r_"]'),g=h.find("> table > tbody > tr"),T=g.map((i,s)=>{let a=h[i].id,t=$(s).find("> td:nth-child(3)"),e=t.find("> strong > a"),m=e.text(),l=e.prop("href"),o=t.find("> .reply_content").text(),c=Number(t.find("span.small").text()),n=t.find("span.no").text(),p=Array.from(o.matchAll(/@(\S+)\s/g)),u=p.length>0?p.map(([,r])=>r):void 0,d=Array.from(o.matchAll(/#(\d+)/g)),w=d.length>0?d.map(([,r])=>r):void 0;return{id:a,memberName:m,memberLink:l,content:o,likes:c,floor:n,index:i,refMemberNames:u,refFloors:w}}).get();function x(){chrome.storage.sync.get("options",i=>{let s=i.options?.["PAT"];s&&f.each((a,t)=>{let e=$(t),m=$('<div class="v2p-topic-index">\u9884\u89C8</div>').on("click",()=>{let o=e.find(".topic-link").attr("href")?.match(/\/(\d+)#/);if(o){let c=o[1];fetch(`${"https://www.v2ex.com/api/v2"}/topics/${c}`,{method:"GET",headers:{Authorization:`Bearer ${s}`}}).then(n=>{console.log(n)}).catch(n=>{console.error(n)})}}).insertAfter(e.find(".count_livid"))})})}$("#Main .tab").addClass("v2p-hover-btn"),$('#Main .topic-link, .item_hot_topic_title > a, .item_node, a[href="/write"]').prop("target","_blank");x();
